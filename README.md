<!--
 * @Author: zyc
 * @Description: file content
 * @Date: 2021-04-21 10:38:54
 * @LastEditTime: 2021-05-08 14:21:00
-->
## æ­¦æ±‰å¤§å­¦åœºé¦†é¢„å®šå°è„šæœ¬

**UPDATE(2022.3.27)ï¼šå­¦æ ¡é¢„çº¦ç³»ç»Ÿè½¬ç§»åˆ°æ™ºæ…§ççˆçš„å°ç¨‹åºäº†ï¼Œæœ¬è„šæœ¬å¤±æ•ˆå•¦ï¼Œè‡ªè°‹ç”Ÿè·¯å§ï¼Œæˆ‘ä¹Ÿç»å¸¸æŠ¢ä¸åˆ°ğŸ˜©**

### ç®€ä»‹

### æŠ€æœ¯æ ˆ
nodejs + puppeteer

> è¯·æŒ‰éœ€é¢„å®šï¼Œç¦æ­¢å•†ç”¨ã€‚

## opencv4nodejs windows å®‰è£…æŒ‡å—

### å‰è¨€

è¯¥åº“ä¾èµ–äº opencv ç¨‹åºï¼Œæ‰€ä»¥å®‰è£…éš¾ç‚¹åœ¨äº opencv çš„å®‰è£…ã€‚

å®˜æ–¹æŒ‡å—ä¸­æäº†ä¸¤ç§å®‰è£…æ–¹å¼ï¼Œä¸€ç§æ˜¯ç›´æ¥ `npm i -S opencv4nodejs` ï¼Œç”± node-gyp æ¥æ„å»º opencv å¤„ç†ç¨‹åºã€‚

å¦ä¸€ç§æ˜¯è‡ªè¡Œå®‰è£… opencv å¤„ç†ç¨‹åºï¼Œç„¶ååœ¨å®‰è£… opencv4nodejs åº“æ—¶ï¼Œé€šè¿‡è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œç¦ç”¨ node-gyp è‡ªå¸¦çš„æ„å»ºã€‚

åœ¨å®é™…å®‰è£…ä¸­ï¼Œä½¿ç”¨ç¬¬ä¸€ç§æ–¹å¼æ€»ä¼šå­˜åœ¨å„ç§é”™è¯¯ï¼Œè£…äº†å¥½ä¹…ä¹Ÿæ²¡è£…æˆåŠŸï¼Œæœ€åé€‰æ‹©ä½¿ç”¨ç¬¬äºŒç§æ–¹å¼è¿›è¡Œï¼Œä»¥ä¸‹ä»‹ç»ä¹Ÿé‡åœ¨è¯´æ˜ç¬¬äºŒç§æ–¹å¼çš„å®è·µã€‚

### 1. å®‰è£… opencv

å¯¹äº opencv çš„å®‰è£…ï¼Œ windows ä¸­ä¹Ÿæœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯ä½¿ç”¨ choco å‘½ä»¤ï¼Œå¦ä¸€ç§æ˜¯åœ¨[å®˜ç½‘](https://opencv.org/releases/)ä¸‹è½½å®‰è£…åŒ…ã€‚

ç¬¬ä¸€ç§éœ€è¦å…ˆåœ¨ç”µè„‘ä¸­å®‰è£… chocolatey åŒ…ç®¡ç†å·¥å…·ï¼Œç„¶åé‡å¯å‘½ä»¤è¡Œçª—å£ï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š

```bat
choco install OpenCV -y -version 4.1.0
```

ç¬¬äºŒç§ç›´æ¥ä¸‹è½½å¾—åˆ°çš„ exe ï¼Œåƒå¸¸è§„è½¯ä»¶å®‰è£…å³å¯ã€‚

### 2. è®¾ç½®ç¯å¢ƒå˜é‡

å®‰è£…åï¼Œåº”å½“å¾—åˆ°å¦‚ä¸‹çš„æ–‡ä»¶ç›®å½•ï¼š

![](./imgs/cv01.png)

éœ€è¦è®¾ç½®å¦‚ä¸‹å‡ ä¸ªç¯å¢ƒå˜é‡ï¼š

- OPENCV_INCLUDE_DIR ï¼šæŒ‡å‘ include æ–‡ä»¶å¤¹
- OPENCV_LIB_DIR ï¼šæŒ‡å‘ lib æ–‡ä»¶å¤¹
- OPENCV_BIN_DIR ï¼šæŒ‡å‘ bin æ–‡ä»¶å¤¹
- Path ä¸­è¿½åŠ  OPENCV_BIN_DIR

![](./imgs/cv02.png)
![](./imgs/cv03.png)

> é™¤äº†ä¸Šè¿°ç›´æ¥è®¾ç½®ç¯å¢ƒå˜é‡çš„æ–¹å¼ï¼Œä¹Ÿå¯ä»¥åœ¨ package.json é…ç½®æ–‡ä»¶ä¸­ä½“ç°(**æ²¡æœ‰å®æµ‹è¿‡**)ï¼š

```js
// package.json
{
  "name": "my-project",
  "version": "0.0.0",
  "dependencies": {
    "opencv4nodejs": "^X.X.X"
  },
  "opencv4nodejs": {
    "disableAutoBuild": 1,
    "opencvIncludeDir": "C:\\tools\\opencv\\build\\include",
    "opencvLibDir": "C:\\tools\\opencv\\build\\x64\\vc14\\lib",
    "opencvBinDir": "C:\\tools\\opencv\\build\\x64\\vc14\\bin"
  }
}
```
### 3. å®‰è£… opencv4nodejs

```bat
# å¦‚æœåœ¨ package.json ä¸­è®¾ç½®è¿‡ï¼Œå°±ä¸éœ€è¦å†åŠ è¿™ä¸ª
set OPENCV4NODEJS_DISABLE_AUTOBUILD=1
npm install --save opencv4nodejs
```

åœ¨å®‰è£…è¿‡ç¨‹ä¸­ï¼Œä¸€ç›´å¡åœ¨ canvas çš„è¿›åº¦ä¸­ï¼Œæœ€åé€‰æ‹©å…ˆæ‰‹åŠ¨å®‰è£… canvas ï¼Œç„¶åå†è£… opencv4nodejs å¯ç ´ã€‚
